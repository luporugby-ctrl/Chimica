<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tavola Periodica Interattiva - Mercatorum</title>
    <!-- Tailwind CSS per lo stile -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React e Babel per far girare il codice JSX nel browser -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;
        
        // Icone Lucide caricate tramite script
        const Search = () => <i data-lucide="search"></i>;
        const X = () => <i data-lucide="x"></i>;
        const Calculator = () => <i data-lucide="calculator"></i>;
        const BookOpen = () => <i data-lucide="book-open"></i>;
        const Hash = () => <i data-lucide="hash"></i>;
        const Sparkles = () => <i data-lucide="sparkles"></i>;
        const Lightbulb = () => <i data-lucide="lightbulb"></i>;
        const BrainCircuit = () => <i data-lucide="brain-circuit"></i>;
        const Send = () => <i data-lucide="send"></i>;

        const ELEMENTS = [
            { number: 1, symbol: 'H', name: 'Idrogeno', mass: 1.008, group: 'non-metal', x: 1, y: 1 },
            { number: 2, symbol: 'He', name: 'Elio', mass: 4.0026, group: 'noble-gas', x: 18, y: 1 },
            { number: 3, symbol: 'Li', name: 'Litio', mass: 6.94, group: 'alkali-metal', x: 1, y: 2 },
            { number: 4, symbol: 'Be', name: 'Berillio', mass: 9.0122, group: 'alkaline-earth', x: 2, y: 2 },
            { number: 5, symbol: 'B', name: 'Boro', mass: 10.81, group: 'metalloid', x: 13, y: 2 },
            { number: 6, symbol: 'C', name: 'Carbonio', mass: 12.011, group: 'non-metal', x: 14, y: 2 },
            { number: 7, symbol: 'N', name: 'Azoto', mass: 14.007, group: 'non-metal', x: 15, y: 2 },
            { number: 8, symbol: 'O', name: 'Ossigeno', mass: 15.999, group: 'non-metal', x: 16, y: 2 },
            { number: 9, symbol: 'F', name: 'Fluoro', mass: 18.998, group: 'halogen', x: 17, y: 2 },
            { number: 10, symbol: 'Ne', name: 'Neon', mass: 20.180, group: 'noble-gas', x: 18, y: 2 },
            { number: 11, symbol: 'Na', name: 'Sodio', mass: 22.990, group: 'alkali-metal', x: 1, y: 3 },
            { number: 12, symbol: 'Mg', name: 'Magnesio', mass: 24.305, group: 'alkaline-earth', x: 2, y: 3 },
            { number: 13, symbol: 'Al', name: 'Alluminio', mass: 26.982, group: 'post-transition', x: 13, y: 3 },
            { number: 14, symbol: 'Si', name: 'Silicio', mass: 28.085, group: 'metalloid', x: 14, y: 3 },
            { number: 15, symbol: 'P', name: 'Fosforo', mass: 30.974, group: 'non-metal', x: 15, y: 3 },
            { number: 16, symbol: 'S', name: 'Zolfo', mass: 32.06, group: 'non-metal', x: 16, y: 3 },
            { number: 17, symbol: 'Cl', name: 'Cloro', mass: 35.45, group: 'halogen', x: 17, y: 3 },
            { number: 18, symbol: 'Ar', name: 'Argon', mass: 39.948, group: 'noble-gas', x: 18, y: 3 },
            { number: 19, symbol: 'K', name: 'Potassio', mass: 39.098, group: 'alkali-metal', x: 1, y: 4 },
            { number: 20, symbol: 'Ca', name: 'Calcio', mass: 40.078, group: 'alkaline-earth', x: 2, y: 4 },
            { number: 21, symbol: 'Sc', name: 'Scandio', mass: 44.956, group: 'transition-metal', x: 3, y: 4 },
            { number: 22, symbol: 'Ti', name: 'Titanio', mass: 47.867, group: 'transition-metal', x: 4, y: 4 },
            { number: 23, symbol: 'V', name: 'Vanadio', mass: 50.942, group: 'transition-metal', x: 5, y: 4 },
            { number: 24, symbol: 'Cr', name: 'Cromo', mass: 51.996, group: 'transition-metal', x: 6, y: 4 },
            { number: 25, symbol: 'Mn', name: 'Manganese', mass: 54.938, group: 'transition-metal', x: 7, y: 4 },
            { number: 26, symbol: 'Fe', name: 'Ferro', mass: 55.845, group: 'transition-metal', x: 8, y: 4 },
            { number: 27, symbol: 'Co', name: 'Cobalto', mass: 58.933, group: 'transition-metal', x: 9, y: 4 },
            { number: 28, symbol: 'Ni', name: 'Nichel', mass: 58.693, group: 'transition-metal', x: 10, y: 4 },
            { number: 29, symbol: 'Cu', name: 'Rame', mass: 63.546, group: 'transition-metal', x: 11, y: 4 },
            { number: 30, symbol: 'Zn', name: 'Zinco', mass: 65.38, group: 'transition-metal', x: 12, y: 4 },
            { number: 31, symbol: 'Ga', name: 'Gallio', mass: 69.723, group: 'post-transition', x: 13, y: 4 },
            { number: 32, symbol: 'Ge', name: 'Germanio', mass: 72.630, group: 'metalloid', x: 14, y: 4 },
            { number: 33, symbol: 'As', name: 'Arsenico', mass: 74.922, group: 'metalloid', x: 15, y: 4 },
            { number: 34, symbol: 'Se', name: 'Selenio', mass: 78.971, group: 'non-metal', x: 16, y: 4 },
            { number: 35, symbol: 'Br', name: 'Bromo', mass: 79.904, group: 'halogen', x: 17, y: 4 },
            { number: 36, symbol: 'Kr', name: 'Kripton', mass: 83.798, group: 'noble-gas', x: 18, y: 4 },
            // Aggiungere altri elementi necessari qui...
            { number: 79, symbol: 'Au', name: 'Oro', mass: 196.97, group: 'transition-metal', x: 11, y: 6 },
            { number: 80, symbol: 'Hg', name: 'Mercurio', mass: 200.59, group: 'transition-metal', x: 12, y: 6 },
        ];

        const GROUP_STYLES = {
            'alkali-metal': 'bg-red-50 border-red-200 text-red-800',
            'alkaline-earth': 'bg-orange-50 border-orange-200 text-orange-800',
            'transition-metal': 'bg-yellow-50 border-yellow-200 text-yellow-800',
            'post-transition': 'bg-green-50 border-green-200 text-green-800',
            'metalloid': 'bg-teal-50 border-teal-200 text-teal-800',
            'non-metal': 'bg-blue-50 border-blue-200 text-blue-800',
            'halogen': 'bg-indigo-50 border-indigo-200 text-indigo-800',
            'noble-gas': 'bg-purple-50 border-purple-200 text-purple-800',
            'lanthanide': 'bg-pink-50 border-pink-200 text-pink-800',
            'actinide': 'bg-rose-50 border-rose-200 text-rose-800',
        };

        const AVOGADRO_NUMBER = 6.022e23;

        function App() {
            const [search, setSearch] = useState('');
            const [selectedElement, setSelectedElement] = useState(null);
            const [massInput, setMassInput] = useState('');
            const [moleInput, setMoleInput] = useState('');
            const [aiLoading, setAiLoading] = useState(false);
            const [aiResponse, setAiResponse] = useState('');
            const [aiError, setAiError] = useState('');

            useEffect(() => { lucide.createIcons(); }, [selectedElement, aiResponse]);

            const apiKey = ""; // Inserisci qui la tua chiave API se lo usi localmente

            const callGemini = async (prompt) => {
                setAiLoading(true); setAiError(''); setAiResponse('');
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                    });
                    const data = await response.json();
                    setAiResponse(data.candidates[0].content.parts[0].text);
                } catch (err) {
                    setAiError("Errore nel contattare l'IA.");
                } finally {
                    setAiLoading(false);
                }
            };

            const isHighlighted = (el) => {
                if (!search) return true;
                const s = search.toLowerCase();
                return el.name.toLowerCase().includes(s) || el.symbol.toLowerCase().includes(s) || el.number.toString() === s;
            };

            return (
                <div className="min-h-screen p-4 md:p-8 flex flex-col items-center">
                    <header className="mb-8 text-center">
                        <h1 className="text-4xl font-extrabold text-slate-800 mb-2">Tavola Periodica & Mole</h1>
                        <p className="text-slate-500 italic">Progetto Ingegneria Gestionale - Università Mercatorum</p>
                    </header>

                    <div className="relative w-full max-w-7xl overflow-x-auto pb-40">
                        <div className="grid gap-1 min-w-[1100px]" style={{ gridTemplateColumns: 'repeat(18, 1fr)' }}>
                            {ELEMENTS.map((el) => (
                                <button
                                    key={el.number}
                                    onClick={() => setSelectedElement(el)}
                                    style={{ gridColumn: el.x, gridRow: el.y }}
                                    className={`relative flex flex-col items-center justify-center p-1 border rounded-lg aspect-square transition-all duration-300 hover:scale-110 hover:z-20 ${GROUP_STYLES[el.group]} ${isHighlighted(el) ? 'opacity-100' : 'opacity-20 grayscale'}`}
                                >
                                    <span className="absolute top-1 left-1 text-[9px] font-bold opacity-60">{el.number}</span>
                                    <span className="text-lg font-black">{el.symbol}</span>
                                    <span className="text-[7px] font-medium uppercase truncate w-full px-1">{el.name}</span>
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Barra di ricerca in basso centrale */}
                    <div className="fixed bottom-8 left-1/2 -translate-x-1/2 w-full max-w-lg px-4 z-30">
                        <div className="relative group">
                            <div className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400">
                                <Search />
                            </div>
                            <input
                                type="text"
                                placeholder="Cerca elemento..."
                                value={search}
                                onChange={(e) => setSearch(e.target.value)}
                                className="w-full pl-12 pr-4 py-4 bg-white rounded-2xl shadow-2xl border border-slate-200 focus:outline-none focus:ring-4 focus:ring-blue-100 font-medium text-slate-700"
                            />
                        </div>
                    </div>

                    {selectedElement && (
                        <div className="fixed inset-0 bg-slate-900/60 backdrop-blur-md z-50 flex items-center justify-center p-4">
                            <div className="w-full max-w-4xl bg-white rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col md:flex-row h-full max-h-[90vh]">
                                <div className={`md:w-1/4 p-8 flex flex-col items-center justify-center text-center ${GROUP_STYLES[selectedElement.group]} shrink-0`}>
                                    <span className="text-2xl font-bold opacity-40 mb-1">#{selectedElement.number}</span>
                                    <div className="text-7xl font-black mb-2">{selectedElement.symbol}</div>
                                    <div className="text-xl font-bold uppercase">{selectedElement.name}</div>
                                </div>
                                <div className="md:w-3/4 p-8 overflow-y-auto bg-white relative">
                                    <button onClick={() => setSelectedElement(null)} className="absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600"><X /></button>
                                    <div className="space-y-6">
                                        <h3 className="text-2xl font-bold flex items-center gap-2 text-slate-800"><Calculator /> Calcolatore Mole</h3>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div className="space-y-2">
                                                <label className="text-xs font-bold text-slate-400 uppercase">Massa (g)</label>
                                                <input type="number" value={massInput} onChange={(e) => setMassInput(e.target.value)} className="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl" />
                                            </div>
                                            <div className="space-y-2">
                                                <label className="text-xs font-bold text-slate-400 uppercase">Moli (mol)</label>
                                                <input type="number" value={moleInput} onChange={(e) => setMoleInput(e.target.value)} className="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl" />
                                            </div>
                                        </div>
                                        <div className="p-4 bg-slate-900 text-blue-300 rounded-2xl text-center">
                                            <div className="text-xl font-bold">{(parseFloat(moleInput || 0) * AVOGADRO_NUMBER).toExponential(2)} Atomi</div>
                                            <span className="text-[10px] uppercase text-slate-500">Numero di Avogadro applicato</span>
                                        </div>
                                        
                                        <div className="pt-6 border-t space-y-4">
                                            <div className="flex gap-2">
                                                <button onClick={() => callGemini(`Dimmi una curiosità su ${selectedElement.name}`)} className="flex-1 py-2 px-4 bg-purple-50 text-purple-700 rounded-lg text-sm font-bold flex items-center justify-center gap-2"><Lightbulb /> Curiosità AI</button>
                                                <button onClick={() => callGemini(`Spiega la mole di ${selectedElement.name} con un'analogia`)} className="flex-1 py-2 px-4 bg-indigo-50 text-indigo-700 rounded-lg text-sm font-bold flex items-center justify-center gap-2"><BrainCircuit /> Analogia AI</button>
                                            </div>
                                            {aiLoading && <div className="p-4 bg-slate-50 rounded-xl animate-pulse text-center text-slate-400">L'IA sta elaborando...</div>}
                                            {aiResponse && <div className="p-4 bg-slate-50 rounded-xl text-slate-700 text-sm italic">{aiResponse}</div>}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
        window.onload = () => lucide.createIcons();
    </script>
</body>
</html>
